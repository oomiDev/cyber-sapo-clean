<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Sistema de Recaudación</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="/css/analytics.css" rel="stylesheet">
</head>
<body>
    <div id="loading-overlay">
        <div class="spinner"></div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/index.html"><i class="fas fa-chart-line me-2"></i>Dashboard de Recaudación</a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/admin.html"><i class="fas fa-tachometer-alt me-1"></i>Admin</a>
                <a class="nav-link" href="/simulador-maquina.html"><i class="fas fa-gamepad me-1"></i>Simulador</a>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <!-- Panel de Filtros -->
        <div class="filter-panel mb-4">
            <div class="row g-3 align-items-end">
                <div class="col-md-2">
                    <label for="region-filter" class="form-label">Región</label>
                    <select id="region-filter" class="form-select"><option value="">Todas</option></select>
                </div>
                <div class="col-md-2">
                    <label for="ciudad-filter" class="form-label">Ciudad</label>
                    <select id="ciudad-filter" class="form-select"><option value="">Todas</option></select>
                </div>
                <div class="col-md-2">
                    <label for="maquina-filter" class="form-label">Máquina</label>
                    <select id="maquina-filter" class="form-select"><option value="">Todas</option></select>
                </div>
                <div class="col-md-2">
                    <label for="start-date" class="form-label">Fecha Inicio</label>
                    <input type="date" id="start-date" class="form-control">
                </div>
                <div class="col-md-2">
                    <label for="end-date" class="form-label">Fecha Fin</label>
                    <input type="date" id="end-date" class="form-control">
                </div>
                <div class="col-md-2 d-grid">
                    <button id="apply-filters" class="btn btn-primary"><i class="bi bi-search"></i> Aplicar Filtros</button>
                </div>
            </div>
        </div>

        <!-- Resumen General -->
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card text-white bg-primary">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-cash-coin"></i> Ingresos Totales</h5>
                        <p class="card-text fs-4" id="total-ingresos">-</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-white bg-info">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-arrow-down-up"></i> Pulsos Totales</h5>
                        <p class="card-text fs-4" id="total-pulsos">-</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-white bg-success">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-robot"></i> Máquinas en Consulta</h5>
                        <p class="card-text fs-4" id="total-maquinas">-</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabla de Datos -->
        <div class="card">
            <div class="card-header">Resultados de la Consulta</div>
            <div class="card-body">
                <div id="loader-container" class="text-center my-5" style="display: none;">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Cargando...</span>
                    </div>
                </div>
                <div id="data-table-container" class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>Código Máquina</th>
                                <th>Nombre</th>
                                <th>Región</th>
                                <th>Ciudad</th>
                                <th>Estado</th>
                                <th>Ingresos</th>
                                <th>Pulsos</th>
                            </tr>
                        </thead>
                        <tbody id="data-table-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="/dashboard.js" defer></script>
</body>
</html>
